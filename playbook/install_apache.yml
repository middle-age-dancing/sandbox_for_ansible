---
- name: Install Apache
  hosts: train

  vars:
    apache_package_name: apache2
    apache_service_name: httpd.apache_service_name
    apache_notify_event: start apache2 service

  tasks:
    - name: Install the https package
      ansible.builtin.apt:
        name:
          - '{{apache_package_name}}'
        state: present
      become: true
      notify:
        - '{{apache_notify_event}}'
  handlers:
    - name: Change the listening port.
      ansible.builtin.lineinfile:
        path: /etc/httpd/conf/httpd.conf
        regexp: '^Listen '
        line: 'Listen 8080'
        validate: httpd -t -f %s
      listen:
        - '{{apache_notify_event}}'
